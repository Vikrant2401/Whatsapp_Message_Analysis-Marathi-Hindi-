import pandas as pd
from wordcloud import WordCloud
import matplotlib.pyplot as plt
import seaborn as sns
from collections import Counter
from nltk.corpus import stopwords
import nltk
import emoji

# Download NLTK stopwords if not already downloaded
nltk.download('stopwords')

# âœ… Custom list of Marathi stopwords (English script)
marathi_stopwords = {
    "ka", "ho", "zala", "pn", "ky", "la", "tr", "nhi", "na", "ok", "ata", "ch",
    "ahe", "ha", "ani", "mg", "hota", "tu", "nay", "kay", "mala", "te", "pan",
    "cha", "ki", "tya", "nahi", "to", "he", "mi", "majha", "tuzha", "amcha",
    "tumcha", "mag", "kahi", "karan", "tar", "ti", "tula", "br", "madhe", "mdhe"
}

# âœ… Common Hindi stopwords (English script)
hindi_stopwords = {
    "hai", "haan", "nahi", "kyu", "kyun", "ho", "gaya", "kya", "kaise", "kar", "raha",
    "rhe", "rhi", "kr", "tha", "thi", "hun", "bhi", "par", "pr", "ab", "aur", "se",
    "sab", "wo", "woh", "jo", "uska", "unka", "mera", "tera", "hamara", "inka",
    "unka", "kuch", "toh", "lekin", "magar", "sirf", "bus", "kyunki", "jab", "tab",
    "fir", "phir", "ki", "ke", "yeh", "vo", "koi", "isse", "usse", "jise", "jaise" , "ğŸ˜€ğŸ˜ƒğŸ˜„ğŸ˜ğŸ˜†ğŸ¥¹ğŸ˜…ğŸ˜‚ğŸ¤£ğŸ˜ğŸ˜ŒğŸ˜‰ğŸ™ƒğŸ™‚ğŸ˜‡ğŸ˜Šâ˜ºï¸ğŸ¥²ğŸ¥°ğŸ˜˜ğŸ˜—ğŸ˜™ğŸ˜šğŸ˜‹ğŸ˜›ğŸ˜ğŸ˜œğŸ˜ğŸ¥³ğŸ¤©ğŸ¥¸ğŸ˜ğŸ¤“ğŸ§ğŸ¤¨ğŸ¤ªğŸ˜’ğŸ˜ğŸ˜”ğŸ˜ŸğŸ˜•ğŸ™â˜¹ï¸ğŸ˜£ğŸ˜–ğŸ¤¬ğŸ˜¡ğŸ˜ ğŸ˜¤ğŸ˜­ğŸ˜¢ğŸ¥ºğŸ˜©ğŸ˜«ğŸ¤¯ğŸ˜³ğŸ¥µğŸ¥¶ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜±ğŸ˜¨ğŸ˜°ğŸ˜¥ğŸ« ğŸ¤«ğŸ«¡ğŸ«¢ğŸ¤­ğŸ«£ğŸ¤”ğŸ¤—ğŸ˜“ğŸ¤¥ğŸ˜¶ğŸ«¥ğŸ˜ğŸ«¤ğŸ˜‘ğŸ˜¬ğŸ™„ğŸ˜¯ğŸ˜®â€ğŸ’¨ğŸ˜ªğŸ¤¤ğŸ˜´ğŸ¥±ğŸ˜²ğŸ˜®ğŸ˜§ğŸ˜¦ğŸ˜µğŸ˜µâ€ğŸ’«ğŸ¤ğŸ¥´ğŸ¤¢ğŸ¤®ğŸ¤§ğŸ˜·ğŸ¤’ğŸ’©ğŸ¤¡ğŸ‘ºğŸ‘¹ğŸ‘¿ğŸ˜ˆğŸ¤ ğŸ¤‘ğŸ¤•ğŸ‘»ğŸ’€â˜ ï¸ğŸ‘½ğŸ‘¾ğŸ¤–ğŸƒğŸ˜ºğŸ˜¸ğŸ¤²ğŸ«¶ğŸ˜¾ğŸ˜¿ğŸ™€ğŸ˜½ğŸ˜¼ğŸ˜»ğŸ˜¹ğŸ‘ğŸ™ŒğŸ‘ğŸ¤ğŸ‘ğŸ‘âœŠğŸ¤›ğŸ‘ŠğŸ¤ğŸ¤ŒğŸ‘ŒğŸ¤˜ğŸ¤ŸğŸ«°âœŒï¸ğŸ¤ğŸ¤œğŸ«³ğŸ«´ğŸ‘ˆğŸ‘‰ğŸ‘†ğŸ‘‡â˜ï¸âœ‹ğŸ¤šğŸ–•ğŸ¦¾ğŸ’ªğŸ«±ğŸ«²ğŸ¤™ğŸ‘‹ğŸ––ğŸ–âœï¸ğŸ™ğŸ«µğŸ¦¶ğŸ¦µğŸ¦¿ğŸ’„ğŸ’‹ğŸ‘„ğŸ‘€ğŸ‘ğŸ‘£ğŸ‘ƒğŸ¦»ğŸ‘‚ğŸ‘…ğŸ¦·ğŸ«¦ğŸ«€ğŸ«ğŸ§ ğŸ—£ğŸ‘¤ğŸ‘¥ğŸ«‚ğŸ‘¶ğŸ‘§ğŸ‘©â€ğŸ¦°ğŸ‘¨â€ğŸ¦±ğŸ§‘â€ğŸ¦±ğŸ‘©â€ğŸ¦±ğŸ‘¨ğŸ§‘ğŸ‘©ğŸ‘¦ğŸ§’ğŸ§‘â€ğŸ¦°ğŸ‘¨â€ğŸ¦°ğŸ‘±â€â™€ï¸ğŸ‘±ğŸ‘±â€â™‚ï¸ğŸ‘©â€ğŸ¦³ğŸ§‘â€ğŸ¦³ğŸ‘¨â€ğŸ¦³ğŸ‘©â€ğŸ¦²ğŸ‘²ğŸ‘´ğŸ§“ğŸ‘µğŸ§”â€â™‚ï¸ğŸ§”ğŸ§”â€â™€ï¸ğŸ‘¨â€ğŸ¦²ğŸ§‘â€ğŸ¦²ğŸ‘³â€â™€ï¸ğŸ‘³ğŸ‘³â€â™‚ï¸ğŸ§•ğŸ‘®â€â™€ï¸ğŸ‘®ğŸ‘®â€â™‚ï¸ğŸ‘·â€â™€ï¸ğŸ‘·ğŸ§‘â€âš•ï¸ğŸ‘©â€âš•ï¸ğŸ•µï¸â€â™‚ï¸ğŸ•µï¸ğŸ•µï¸â€â™€ï¸ğŸ’‚â€â™‚ï¸ğŸ’‚ğŸ’‚â€â™€ï¸ğŸ‘·â€â™‚ï¸ğŸ‘¨â€âš•ï¸ğŸ‘©â€ğŸŒ¾ğŸ§‘â€ğŸŒ¾ğŸ‘©â€ğŸ³ğŸ§‘â€ğŸ³ğŸ‘¨â€ğŸ³ğŸ‘©â€ğŸ“ğŸ§‘â€ğŸ“ğŸ‘¨â€ğŸŒ¾ğŸ§‘â€ğŸ­ğŸ‘©â€ğŸ­ğŸ‘¨â€ğŸ«ğŸ§‘â€ğŸ«ğŸ‘©â€ğŸ«ğŸ‘¨â€ğŸ¤ğŸ§‘â€ğŸ¤ğŸ‘©â€ğŸ¤ğŸ‘¨â€ğŸ“ğŸ‘¨â€ğŸ­ğŸ‘©â€ğŸ’»ğŸ§‘â€ğŸ’»ğŸ‘¨â€ğŸ’»ğŸ‘©â€ğŸ’¼ğŸ§‘â€ğŸ’¼ğŸ‘¨â€ğŸ’¼ğŸ‘©â€ğŸ”§ğŸ§‘â€ğŸ”§ğŸ§‘â€ğŸš’ğŸ‘©â€ğŸš’ğŸ‘¨â€ğŸ¨ğŸ§‘â€ğŸ¨ğŸ‘©â€ğŸ¨ğŸ‘¨â€ğŸ”¬ğŸ§‘â€ğŸ”¬ğŸ‘©â€ğŸ”¬ğŸ‘¨â€ğŸ”§ğŸ‘¨â€ğŸš’ğŸ‘©â€âœˆï¸ğŸ§‘â€âœˆï¸ğŸ‘¨â€âœˆï¸ğŸ‘©â€ğŸš€ğŸ§‘â€ğŸš€ğŸ‘¨â€ğŸš€ğŸ‘©â€âš–ï¸ğŸ§‘â€âš–ï¸ğŸ«…ğŸ‘¸ğŸ¤µâ€â™‚ï¸ğŸ¤µğŸ¤µâ€â™€ï¸ğŸ‘°â€â™‚ï¸ğŸ‘°ğŸ‘°â€â™€ï¸ğŸ‘¨â€âš–ï¸ğŸ¤´ğŸ¥·ğŸ¦¸â€â™€ï¸ğŸ¦¸ğŸ¦¸â€â™‚ï¸ğŸ¦¹ğŸ¦¹â€â™‚ï¸ğŸ¤¶ğŸ¦¹â€â™€ï¸ğŸ§ŒğŸ§â€â™‚ï¸ğŸ§ğŸ§â€â™€ï¸ğŸ§™â€â™‚ï¸ğŸ§™ğŸ§™â€â™€ï¸ğŸ…ğŸ§‘â€ğŸ„ğŸ§›â€â™€ï¸ğŸ§›ğŸ§›â€â™‚ï¸ğŸ§Ÿâ€â™€ï¸ğŸ§ŸğŸ§Ÿâ€â™‚ï¸ğŸ§â€â™€ï¸ğŸ§ğŸ§â€â™‚ï¸ğŸ«„ğŸ¤°ğŸ‘¼ğŸ§šâ€â™‚ï¸ğŸ§šğŸ§šâ€â™€ï¸ğŸ§œâ€â™‚ï¸ğŸ§œğŸ§œâ€â™€ï¸ğŸ«ƒğŸ¤±ğŸ‘©â€ğŸ¼ğŸ§‘â€ğŸ¼ğŸ‘¨â€ğŸ¼ğŸ™‡â€â™€ï¸ğŸ™‡ğŸ™‡â€â™‚ï¸ğŸ’â€â™€ï¸ğŸ™‹â€â™€ï¸ğŸ™†â€â™‚ï¸ğŸ™†ğŸ™†â€â™€ï¸ğŸ™…â€â™‚ï¸ğŸ™…ğŸ™…â€â™€ï¸ğŸ’â€â™‚ï¸ğŸ’ğŸ™‹ğŸ™‹â€â™‚ï¸ğŸ§â€â™€ï¸ğŸ§ğŸ§â€â™‚ï¸ğŸ¤¦â€â™€ï¸ğŸ¤¦ğŸ¤¦â€â™‚ï¸ğŸ¤·â€â™€ï¸ğŸ’‡â€â™€ï¸ğŸ™â€â™‚ï¸ğŸ™ğŸ™â€â™€ï¸ğŸ™â€â™‚ï¸ğŸ™ğŸ™â€â™€ï¸ğŸ¤·â€â™‚ï¸ğŸ¤·ğŸ’‡ğŸ’‡â€â™‚ï¸ğŸ’†â€â™€ï¸ğŸ’†ğŸ’†â€â™‚ï¸ğŸ§–â€â™€ï¸ğŸ§–ğŸ§–â€â™‚ï¸ğŸ’…ğŸ§‘â€ğŸ¦½ğŸ‘©â€ğŸ¦½ğŸ•´ğŸ‘¯â€â™‚ï¸ğŸ‘¯ğŸ‘¯â€â™€ï¸ğŸ•ºğŸ’ƒğŸ¤³ğŸ‘¨â€ğŸ¦½ğŸ§‘â€ğŸ¦¼ğŸ‘¨â€ğŸ¦¼ğŸš¶â€â™€ï¸ğŸš¶ğŸš¶â€â™‚ï¸ğŸ‘©â€ğŸ¦¯ğŸ§‘â€ğŸ¦¯ğŸ§ğŸ§â€â™€ï¸ğŸƒâ€â™‚ï¸ğŸƒğŸƒâ€â™€ï¸ğŸ§â€â™‚ï¸ğŸ§ğŸ§â€â™€ï¸ğŸ‘¨â€ğŸ¦¯ğŸ§â€â™‚ï¸ğŸ‘«ğŸ‘­ğŸ‘¬ğŸ‘©â€â¤ï¸â€ğŸ‘¨ğŸ‘©â€â¤ï¸â€ğŸ‘©ğŸ’‘ğŸ‘¨â€â¤ï¸â€ğŸ‘¨ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨ğŸ‘©â€ğŸ‘©â€ğŸ‘¦ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨ğŸ’ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘©ğŸ‘©â€ğŸ‘©â€ğŸ‘§ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ‘©â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘§ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ğŸ‘¨â€ğŸ‘§ğŸ‘¨â€ğŸ‘¦ğŸ‘©â€ğŸ‘§â€ğŸ‘§ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ‘©â€ğŸ‘§ğŸ‘©â€ğŸ‘¦ğŸ‘¨â€ğŸ‘§â€ğŸ‘§ğŸª¢ğŸ§¶ğŸ§µğŸª¡ğŸ§¥ğŸ¥¼ğŸ¦ºğŸ‘šğŸ‘˜ğŸ©±ğŸ‘™ğŸ‘—ğŸ‘”ğŸ©³ğŸ©²ğŸ‘–ğŸ‘•ğŸ¥»ğŸ©´ğŸ¥¿ğŸ‘ ğŸ‘¡ğŸ‘¢ğŸ‘ğŸ‘ŸğŸ¥¾ğŸª–â›‘ğŸ‘’ğŸ“ğŸ§¢ğŸ©ğŸ§£ğŸ§¤ğŸ§¦ğŸ‘‘ğŸ’ğŸ‘ğŸ‘›ğŸ‘œğŸ’¼ğŸ’ğŸ§³ğŸ‘“ğŸŒ‚ğŸ¥½ğŸ•¶â¤ï¸ğŸ§¡ğŸ’›ğŸ’šğŸ’™ğŸ’œğŸ¤ğŸ–¤ğŸ¤ğŸ’–ğŸ’—ğŸ’“ğŸ’ğŸ’•â£ï¸â¤ï¸â€ğŸ©¹â¤ï¸â€ğŸ”¥ğŸ’”ğŸ’˜ğŸ’â™¡â™¥ï¸â¥â¦â§â˜™â¢à¦áƒšáƒ“áƒ¦ÉÊšà·†á°”á©šá°”à¦à¬“áœŠá¥«á­¡ê¨„à®á¦—ğŸ¶ğŸ±ğŸ­ğŸ¹ğŸ°ğŸ¦ŠğŸ»ğŸ¼ğŸ»â€â„ï¸ğŸ™ˆğŸµğŸ¸ğŸ½ğŸ·ğŸ®ğŸ¦ğŸ¯ğŸ¨ğŸ™‰ğŸ™ŠğŸ’ğŸ”ğŸ§ğŸ¦ğŸ¤ğŸ£ğŸ¥ğŸğŸ¦„ğŸ´ğŸ—ğŸºğŸ¦‡ğŸ¦‰ğŸ¦…ğŸ¦†ğŸª±ğŸ›ğŸ¦‹ğŸŒğŸğŸœğŸª°ğŸª²ğŸª³ğŸ¦–ğŸ¦ğŸğŸ¢ğŸ¦‚ğŸ•¸ğŸ•·ğŸ¦—ğŸ¦ŸğŸ¦•ğŸ™ğŸ¦‘ğŸ¦ğŸ¦ğŸ¦€ğŸ¡ğŸ ğŸŸğŸ¦“ğŸ†ğŸ…ğŸŠğŸ¦­ğŸ¦ˆğŸ‹ğŸ³ğŸ¬ğŸ¦ğŸ¦§ğŸ¦£ğŸ˜ğŸ¦›ğŸ¦ğŸªğŸ«ğŸ¦’ğŸ‘ğŸğŸ–ğŸğŸ„ğŸ‚ğŸƒğŸ¦¬ğŸ¦˜ğŸ¦™ğŸğŸ¦ŒğŸ•ğŸ©ğŸ¦®ğŸ•â€ğŸ¦ºğŸˆğŸˆâ€â¬›ğŸ•ŠğŸ¦©ğŸ¦¢ğŸ¦œğŸ¦šğŸ¦¤ğŸ¦ƒğŸ“ğŸª¶ğŸ‡ğŸ¦ğŸ¦¨ğŸ¦¡ğŸ¦«ğŸ¦¦ğŸ¦¥ğŸğŸ€ğŸŒ³ğŸŒ²ğŸ„ğŸŒµğŸ²ğŸ‰ğŸ¾ğŸ¦”ğŸ¿ğŸŒ´ğŸªµğŸŒ±ğŸŒ¿â˜˜ï¸ğŸ€ğŸğŸª´ğŸ‹ğŸª¨ğŸª¸ğŸšğŸ„ğŸª¹ğŸªºğŸğŸ‚ğŸƒğŸŒ¾ğŸ’ğŸŒ·ğŸŒ¹ğŸ¥€ğŸª·ğŸŒºğŸŒ¸ğŸŒ¼ğŸŒ—ğŸŒ–ğŸŒ•ğŸŒšğŸŒœğŸŒ›ğŸŒğŸŒğŸŒ»ğŸŒ˜ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ™ğŸŒğŸŒğŸŒğŸ”¥ğŸ’¥â˜„ï¸âš¡ï¸âœ¨ğŸŒŸâ­ï¸ğŸ’«ğŸªğŸŒªğŸŒˆâ˜€ï¸ğŸŒ¤â›…ï¸ğŸŒ¥â˜ï¸ğŸŒ¦ğŸŒ§ğŸ’§ğŸ’¨ğŸŒ¬â›„ï¸â˜ƒï¸â„ï¸ğŸŒ¨ğŸŒ©â›ˆğŸ’¦ğŸ«§â˜”ï¸â˜‚ï¸ğŸŒŠğŸğŸğŸğŸŠğŸ‹ğŸŒğŸ‰ğŸ‡ğŸ“ğŸ…ğŸ¥ğŸ¥¥ğŸğŸ¥­ğŸ‘ğŸ’ğŸˆğŸ«ğŸ†ğŸ¥‘ğŸ¥¦ğŸ¥¬ğŸ¥’ğŸŒ¶ğŸ«‘ğŸŒ½ğŸ¥•ğŸ¥–ğŸğŸ¥¯ğŸ¥ğŸ ğŸ¥”ğŸ§…ğŸ§„ğŸ«’ğŸ¥¨ğŸ§€ğŸ¥šğŸ³ğŸ§ˆğŸ¥ğŸ§‡ğŸ¥“ğŸ¥©ğŸ¥ªğŸ«“ğŸ•ğŸŸğŸ”ğŸŒ­ğŸ¦´ğŸ–ğŸ—ğŸ¥™ğŸ§†ğŸŒ®ğŸŒ¯ğŸ«”ğŸ¥—ğŸ¥˜ğŸ«•ğŸ¥«ğŸ¦ªğŸ¥ŸğŸ±ğŸ£ğŸ›ğŸ²ğŸœğŸğŸ«™ğŸ¤ğŸ™ğŸšğŸ˜ğŸ¥ğŸ¥ ğŸ¥®ğŸ¢ğŸ¡ğŸ­ğŸ®ğŸ‚ğŸ°ğŸ§ğŸ¥§ğŸ¦ğŸ¨ğŸ§ğŸ¬ğŸ«ğŸ¿ğŸ©ğŸªğŸŒ°ğŸ¥œğŸ«˜ğŸ¯ğŸ§‹ğŸ¥¤ğŸ§ƒğŸµâ˜•ï¸ğŸ«–ğŸ¼ğŸ«—ğŸ¥›ğŸ¶ğŸºğŸ»ğŸ¥‚ğŸ·ğŸ¥ƒğŸ¸ğŸ¹ğŸ§‰ğŸ§‚ğŸ¥¢ğŸ¥¡ğŸ¥£ğŸ½ğŸ´ğŸ¥„ğŸ§ŠğŸ¾âš½ï¸ğŸ€ğŸˆâš¾ï¸ğŸ¥ğŸ¾ğŸğŸ‰ğŸ¥ğŸªƒğŸğŸ¥ğŸ‘ğŸ’ğŸ¸ğŸ“ğŸª€ğŸ±ğŸ¥…â›³ï¸ğŸªğŸ›ğŸ¹ğŸ£ğŸ¤¿ğŸ¥ŠğŸ¥‹ğŸ‚â›·ğŸ¿ğŸ¥Œâ›¸ğŸ›·ğŸ›¼ğŸ›¹ğŸ½ğŸª‚ğŸ‹ï¸â€â™€ï¸ğŸ‹ï¸ğŸ‹ï¸â€â™‚ï¸ğŸ¤¼â€â™€ï¸ğŸ¤¼ğŸ¤¼â€â™‚ï¸ğŸ¤¸â€â™€ï¸ğŸ¤¸ğŸŒï¸â€â™€ï¸ğŸ¤¾â€â™‚ï¸ğŸ¤¾ğŸ¤¾â€â™€ï¸ğŸ¤ºâ›¹ï¸â€â™‚ï¸â›¹ï¸â›¹ï¸â€â™€ï¸ğŸ¤¸â€â™‚ï¸ğŸŒï¸ğŸŒï¸â€â™‚ï¸ğŸ‡ğŸ§˜â€â™€ï¸ğŸ§˜ğŸ§˜â€â™‚ï¸ğŸ„â€â™€ï¸ğŸ„ğŸ„â€â™‚ï¸ğŸš£â€â™‚ï¸ğŸš£ğŸš£â€â™€ï¸ğŸ¤½â€â™‚ï¸ğŸ¤½ğŸ¤½â€â™€ï¸ğŸŠâ€â™‚ï¸ğŸŠğŸŠâ€â™€ï¸ğŸ§—â€â™€ï¸ğŸ§—ğŸ§—â€â™‚ï¸ğŸšµâ€â™€ï¸ğŸšµğŸšµâ€â™‚ï¸ğŸš´â€â™€ï¸ğŸš´ğŸš´â€â™‚ï¸ğŸ«ğŸ—ğŸµğŸ–ğŸ…ğŸ¥‰ğŸ¥ˆğŸ¥‡ğŸ†ğŸŸğŸªğŸ¤¹â€â™€ï¸ğŸ¤¹ğŸ¤¹â€â™‚ï¸ğŸ­ğŸ©°ğŸ¨ğŸ¬ğŸª—ğŸºğŸ·ğŸª˜ğŸ¥ğŸ¹ğŸ¼ğŸ§ğŸ¤ğŸ¸ğŸª•ğŸ»ğŸ²â™ŸğŸ¯ğŸ³ğŸ®ğŸ°ğŸ§©ğŸš—ğŸš•ğŸš™ğŸšŒğŸšğŸğŸš“ğŸš‘ğŸš’ğŸ©¼ğŸ¦¼ğŸ¦½ğŸ¦¯ğŸšœğŸš›ğŸššğŸ›»ğŸšğŸ›´ğŸš²ğŸ›µğŸğŸ›ºğŸ›ğŸš¨ğŸš”ğŸšğŸšğŸšğŸš‹ğŸšƒğŸšŸğŸš ğŸš¡ğŸš–ğŸš˜ğŸš„ğŸš…ğŸšˆğŸš‚ğŸš†ğŸš‡ğŸšŠğŸš‰âœˆï¸ğŸ›¶ğŸšğŸ›¸ğŸš€ğŸ›°ğŸ’ºğŸ›©ğŸ›¬ğŸ›«â›µï¸ğŸš¤ğŸ›¥ğŸ›³ğŸš¢ğŸ›Ÿâ›´âš“ï¸ğŸªğŸ—¼ğŸ—½ğŸ—¿ğŸ—ºğŸšğŸš¥ğŸš¦ğŸš§â›½ï¸ğŸ°ğŸ¯ğŸŸğŸ¡ğŸ¢ğŸ â›²ï¸â›±ğŸ–ğŸ›–â›ºï¸ğŸ•ğŸ—»ğŸ”â›°ğŸŒ‹ğŸœğŸğŸ ğŸ¡ğŸ˜ğŸšğŸ—ğŸ­ğŸ¢ğŸ¬ğŸ£ğŸ›ğŸ’’ğŸ©ğŸ«ğŸªğŸ¨ğŸ¦ğŸ¥ğŸ¤â›ªï¸ğŸ•ŒğŸ•ğŸ›•ğŸ•‹â›©ğŸ›¤ğŸ›£ğŸ—¾ğŸŒ†ğŸŒ‡ğŸ†ğŸ‡ğŸŒ ğŸŒ„ğŸŒ…ğŸğŸ‘ğŸ™ğŸŒƒğŸŒŒğŸŒ‰ğŸŒâŒšï¸ğŸ“±ğŸ“²ğŸ’»âŒ¨ï¸ğŸ–¥ğŸ–¨ğŸ–±ğŸ–²ğŸ“¸ğŸ“·ğŸ“¼ğŸ“€ğŸ’¿ğŸ’¾ğŸ’½ğŸ—œğŸ•¹ğŸ“¹ğŸ¥ğŸ“½ğŸğŸ“â˜ï¸ğŸ“ŸğŸ“ ğŸ“ºğŸ•°â°â²â±ğŸ§­ğŸ›ğŸšğŸ™ğŸ“»âŒ›ï¸â³ğŸ“¡ğŸ”‹ğŸª«ğŸ”ŒğŸ’¡ğŸ”¦ğŸ•¯ğŸª™ğŸ’·ğŸ’¶ğŸ’´ğŸ’µğŸ’¸ğŸ›¢ğŸ§¯ğŸª”ğŸ’°ğŸ’³ğŸªªğŸ’âš–ï¸ğŸªœğŸ§°ğŸª›ğŸ”§ğŸ§±ğŸª¤âš™ï¸ğŸ”©ğŸªšâ›ğŸ› âš’ğŸ”¨â›“ğŸ§²ğŸ”«ğŸ’£ğŸ§¨ğŸª“ğŸ”ªğŸ—¡âš”ï¸ğŸ§¿ğŸ“¿ğŸ”®ğŸºâš±ï¸ğŸª¦âš°ï¸ğŸš¬ğŸ›¡ğŸª¬ğŸ’ˆâš—ï¸ğŸ”­ğŸ”¬ğŸ•³ğŸ©»ğŸ©¹ğŸ©ºğŸ§¹ğŸŒ¡ğŸ§ªğŸ§«ğŸ¦ ğŸ§¬ğŸ©¸ğŸ’‰ğŸ’ŠğŸª ğŸ§ºğŸ§»ğŸš½ğŸš°ğŸš¿ğŸ›ğŸ›€ğŸ§¼ğŸšªğŸ—ğŸ”‘ğŸ›ğŸ§´ğŸª£ğŸ§½ğŸª’ğŸª¥ğŸª‘ğŸ›‹ğŸ›ğŸ›ŒğŸ§¸ğŸª†ğŸ–¼ğŸªğŸªŸğŸŠğŸª…ğŸª„ğŸ€ğŸğŸˆğŸğŸ›’ğŸ›ğŸ‰ğŸğŸ®ğŸğŸª©ğŸ§§âœ‰ï¸ğŸ“©ğŸ“¨ğŸ“«ğŸ“ªğŸª§ğŸ·ğŸ“¦ğŸ“¤ğŸ“¥ğŸ’ŒğŸ“§ğŸ“¬ğŸ“­ğŸ“®ğŸ“¯ğŸ“œğŸ“ƒğŸ“„ğŸ“‘ğŸ§¾ğŸ“‡ğŸ—‘ğŸ“…ğŸ“†ğŸ—“ğŸ—’ğŸ“‰ğŸ“ˆğŸ“ŠğŸ—ƒğŸ—³ğŸ—„ğŸ“‹ğŸ“‚ğŸ“ğŸ—‚ğŸ—ğŸ“°ğŸ“–ğŸ“šğŸ“™ğŸ“˜ğŸ“—ğŸ“•ğŸ“’ğŸ“”ğŸ““ğŸ”–ğŸ§·ğŸ”—ğŸ“ğŸ–‡ğŸ“ğŸ“ğŸ§®ğŸ“Œâœï¸ğŸ“ğŸ–ğŸ–Œâœ’ï¸ğŸ–‹ğŸ–Šâœ‚ï¸ğŸ“ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”’ğŸ”“â¤ï¸ğŸ§¡ğŸ’›ğŸ’šğŸ’™ğŸ’œğŸ¤ğŸ–¤ğŸ¤âšªï¸âš«ï¸ğŸŸ¤ğŸŸ£ğŸ”µğŸŸ¢ğŸŸ¡ğŸŸ ğŸ”´ğŸŸ¥ğŸŸ§ğŸŸ¨ğŸŸ©ğŸŸ¦ğŸŸ«â¬›ï¸â¬œï¸â¤ï¸â€ğŸ©¹â£ï¸â¤ï¸â€ğŸ”¥ğŸ’”ğŸ¿ğŸ¾ğŸ½ğŸ¼ğŸ»ğŸ’•ğŸ’ğŸ’“ğŸ’—ğŸ’–ğŸ’˜ğŸ’ğŸ’Ÿâ˜®ï¸â˜¦ï¸â˜¯ï¸ğŸ•ğŸ”¯âœ¡ï¸â˜¸ï¸ğŸ•‰â˜ªï¸âœï¸ğŸ›â›â™ˆï¸â™‰ï¸â™Šï¸â™‹ï¸â™Œï¸â™ï¸â™ï¸âš›ï¸ğŸ†”â™“ï¸â™’ï¸â™‘ï¸â™ï¸â™ï¸ğŸ‰‘â˜¢ï¸ğŸ“´ğŸ“³ğŸˆ¶ğŸˆšï¸ğŸˆ¸ğŸˆºğŸˆ·ï¸âœ´ï¸ğŸˆ²ğŸˆ¹ğŸˆµğŸˆ´ãŠ—ï¸ãŠ™ï¸ğŸ‰ğŸ’®ğŸ†šğŸ…°ï¸ğŸ…±ï¸ğŸ†ğŸ…¾ï¸ğŸ†‘ğŸ†˜âŒâ­•ï¸ğŸ›‘ğŸš³ğŸš¯ğŸš·â™¨ï¸ğŸ’¢ğŸ’¯ğŸš«ğŸ“›â›”ï¸ğŸš±ğŸ”ğŸ“µğŸš­â—ï¸â•â“â”â€¼ï¸ğŸ”°âšœï¸ğŸ”±ğŸš¸âš ï¸ã€½ï¸ğŸ”†ğŸ”…â‰ï¸â™»ï¸âœ…ğŸˆ¯ï¸ğŸ’¹â‡ï¸âœ³ï¸âğŸŒğŸ’ ğŸˆ³ğŸ›—ğŸ…¿ï¸â™¿ï¸ğŸš¾ğŸ§ğŸ’¤ğŸŒ€â“‚ï¸ğŸˆ‚ï¸ğŸ›‚ğŸ›ƒğŸ›„ğŸ›…ğŸš¹ğŸšºğŸš¼âš§ğŸ”¡ğŸ”¤â„¹ï¸ğŸ”£ğŸˆğŸ“¶ğŸ¦ğŸš®ğŸš»ğŸ” ğŸ†–ğŸ†—ğŸ†™ğŸ†’ğŸ†•ğŸ†“0ï¸âƒ£1ï¸âƒ£ğŸ”Ÿ9ï¸âƒ£8ï¸âƒ£7ï¸âƒ£6ï¸âƒ£5ï¸âƒ£4ï¸âƒ£3ï¸âƒ£2ï¸âƒ£ğŸ”¢#ï¸âƒ£*ï¸âƒ£âï¸â–¶ï¸â¸â¯â¹âºğŸ”½ğŸ”¼â—€ï¸â¬â«âªâ©â®â­â¡ï¸â¬…ï¸â¬†ï¸â¬‡ï¸â†—ï¸â†˜ï¸â†™ï¸â†–ï¸â†•ï¸ğŸ”„ğŸ”‚ğŸ”ğŸ”€â¤µï¸â¤´ï¸â†©ï¸â†ªï¸â†”ï¸ğŸ”ƒğŸµğŸ¶â•â–â—âœ–ï¸ğŸŸ°â™¾ï¸ğŸ”›ğŸ”™ğŸ”šğŸ‘â€ğŸ—¨Â®ï¸Â©ï¸â„¢ï¸ğŸ’±ğŸ’²ğŸ”ğŸ”œã€°ï¸â°â¿âœ”ï¸â˜‘ï¸ğŸ”˜ğŸ”ºâ–«ï¸â–ªï¸ğŸ”²ğŸ”³ğŸ”·ğŸ”¶ğŸ”¹ğŸ”¸ğŸ”»â—¾ï¸â—½ï¸â—¼ï¸â—»ï¸ğŸ”ˆğŸ”‡ğŸ”‰ğŸ”ŠğŸ””â™¥ï¸â™£ï¸â™ ï¸ğŸ—¯ğŸ’­ğŸ’¬ğŸ“¢ğŸ“£ğŸ”•â™¦ï¸ğŸƒğŸ´ğŸ€„ï¸ğŸ•ğŸ•‘ğŸ•’ğŸ•“ğŸ•”ğŸ•ğŸ•œğŸ•›ğŸ•šğŸ•™ğŸ•˜ğŸ•—ğŸ•–ğŸ••ğŸ•ğŸ•ŸğŸ• ğŸ•¡ğŸ•¢ğŸ•£ğŸ•¤ğŸ•¥ğŸ•¦ğŸ•§ğŸ³ï¸ğŸ´ğŸ´â€â˜ ï¸ğŸğŸš©ğŸ³ï¸â€ğŸŒˆğŸ³ï¸â€âš§ï¸ğŸ‡ºğŸ‡³ğŸ‡®ğŸ‡¸ğŸ‡¦ğŸ‡±ğŸ‡¦ğŸ‡¼ğŸ‡¦ğŸ‡·ğŸ‡©ğŸ‡¿ğŸ‡¦ğŸ‡ªğŸ‡ºğŸ‡¸ğŸ‡¦ğŸ‡«ğŸ‡¦ğŸ‡¿ğŸ‡®ğŸ‡ªğŸ‡¦ğŸ‡²ğŸ‡¦ğŸ‡®ğŸ‡¦ğŸ‡´ğŸ‡¦ğŸ‡¬ğŸ‡¦ğŸ‡©ğŸ‡¾ğŸ‡ªğŸ‡¬ğŸ‡§ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿ğŸ‡ºğŸ‡¬ğŸ‡¼ğŸ‡«ğŸ‡®ğŸ‡©ğŸ‡®ğŸ‡³ğŸ‡®ğŸ‡·ğŸ‡®ğŸ‡¶ğŸ‡®ğŸ‡¹ğŸ‡®ğŸ‡±ğŸ´ó §ó ¢ó ·ó ¬ó ³ó ¿ğŸ‡ºğŸ‡¦ğŸ‡ºğŸ‡¿ğŸ‡ºğŸ‡¾ğŸ‡ªğŸ‡¨ğŸ‡ªğŸ‡¬ğŸ‡ªğŸ‡ªğŸ‡¸ğŸ‡¿ğŸ‡ªğŸ‡¹ğŸ‡ªğŸ‡·ğŸ‡¨ğŸ‡»ğŸ‡¬ğŸ‡­ğŸ‡§ğŸ‡¶ğŸ‡³ğŸ‡±ğŸ‡´ğŸ‡²ğŸ‡¦ğŸ‡½ğŸ‡¦ğŸ‡¹ğŸ‡¦ğŸ‡ºğŸ‡¸ğŸ‡»ğŸ‡¬ğŸ‡¬ğŸ‡¬ğŸ‡¾ğŸ‡°ğŸ‡¿ğŸ‡¨ğŸ‡¦ğŸ‡®ğŸ‡¨ğŸ‡¬ğŸ‡¦ğŸ‡¨ğŸ‡²ğŸ‡¬ğŸ‡²ğŸ‡°ğŸ‡¬ğŸ‡°ğŸ‡®ğŸ‡¬ğŸ‡·ğŸ‡¨ğŸ‡¼ğŸ‡¨ğŸ‡ºğŸ‡¨ğŸ‡¾ğŸ‡¬ğŸ‡¼ğŸ‡¬ğŸ‡³ğŸ‡°ğŸ‡­ğŸ‡¬ğŸ‡¹ğŸ‡¬ğŸ‡µğŸ‡¬ğŸ‡ºğŸ‡°ğŸ‡¼ğŸ‡¨ğŸ‡°ğŸ‡¬ğŸ‡±ğŸ‡¨ğŸ‡½ğŸ‡¬ğŸ‡©ğŸ‡­ğŸ‡·ğŸ‡¨ğŸ‡¬ğŸ‡¨ğŸ‡´ğŸ‡°ğŸ‡²ğŸ‡½ğŸ‡°ğŸ‡¨ğŸ‡·ğŸ‡¨ğŸ‡¨ğŸ‡¨ğŸ‡®ğŸ‡°ğŸ‡ªğŸ‡°ğŸ‡¾ğŸ‡¨ğŸ‡©ğŸ‡¸ğŸ‡¦ğŸ‡¬ğŸ‡¸ğŸ‡¼ğŸ‡¸ğŸ‡§ğŸ‡±ğŸ‡¸ğŸ‡¹ğŸ‡¿ğŸ‡²ğŸ‡µğŸ‡²ğŸ‡¸ğŸ‡²ğŸ‡¸ğŸ‡½ğŸ‡¸ğŸ‡¬ğŸ‡¸ğŸ‡¾ğŸ‡¬ğŸ‡ªğŸ‡¯ğŸ‡²ğŸ‡¯ğŸ‡ªğŸ‡¬ğŸ‡®ğŸ‡©ğŸ‡¯ğŸ‡¸ğŸ‡±ğŸ‡¿ğŸ‡¼ğŸ‡¨ğŸ‡­ğŸ‡¸ğŸ‡ªğŸ‡¸ğŸ‡©ğŸ‡ªğŸ‡¸ğŸ‡¸ğŸ‡·ğŸ‡±ğŸ‡°ğŸ‡¸ğŸ‡°ğŸ‡¸ğŸ‡®ğŸ‡¸ğŸ‡§ğŸ‡¸ğŸ‡´ğŸ‡±ğŸ‡¨ğŸ‡¸ğŸ‡­ğŸ‡»ğŸ‡¨ğŸ‡°ğŸ‡³ğŸ‡·ğŸ‡¸ğŸ‡¸ğŸ‡³ğŸ‡¸ğŸ‡¨ğŸ‡¹ğŸ‡¨ğŸ‡¹ğŸ‡­ğŸ‡¹ğŸ‡¯ğŸ‡¨ğŸ‡¿ğŸ‡®ğŸ‡´ğŸ‡¹ğŸ‡©ğŸ‡¹ğŸ‡³ğŸ‡¨ğŸ‡±ğŸ‡¹ğŸ‡²ğŸ‡¹ğŸ‡¹ğŸ‡©ğŸ‡²ğŸ‡©ğŸ‡´ğŸ‡¹ğŸ‡°ğŸ‡¹ğŸ‡¬ğŸ‡©ğŸ‡ªğŸ‡©ğŸ‡°ğŸ‡¹ğŸ‡»ğŸ‡¹ğŸ‡·ğŸ‡¹ğŸ‡´ğŸ‡³ğŸ‡¬ğŸ‡³ğŸ‡·ğŸ‡³ğŸ‡¦ğŸ‡³ğŸ‡ºğŸ‡³ğŸ‡®ğŸ‡³ğŸ‡ªğŸ‡³ğŸ‡¨ğŸ‡»ğŸ‡¦ğŸ‡µğŸ‡°ğŸ‡­ğŸ‡¹ğŸ‡§ğŸ‡­ğŸ‡³ğŸ‡´ğŸ‡³ğŸ‡«ğŸ‡³ğŸ‡µğŸ‡³ğŸ‡¿ğŸ‡»ğŸ‡ºğŸ‡§ğŸ‡¸ğŸ‡µğŸ‡¬ğŸ‡§ğŸ‡²ğŸ‡µğŸ‡¼ğŸ‡µğŸ‡¾ğŸ‡§ğŸ‡§ğŸ‡µğŸ‡¸ğŸ‡­ğŸ‡ºğŸ‡«ğŸ‡°ğŸ‡«ğŸ‡´ğŸ‡µğŸ‡·ğŸ‡§ğŸ‡¹ğŸ‡«ğŸ‡®ğŸ‡µğŸ‡­ğŸ‡«ğŸ‡¯ğŸ‡µğŸ‡³ğŸ‡§ğŸ‡©ğŸ‡§ğŸ‡·ğŸ‡«ğŸ‡·ğŸ‡§ğŸ‡¬ğŸ‡§ğŸ‡«ğŸ‡§ğŸ‡³ğŸ‡§ğŸ‡®ğŸ‡»ğŸ‡³ğŸ‡§ğŸ‡¯ğŸ‡»ğŸ‡ªğŸ‡µğŸ‡¹ğŸ‡§ğŸ‡´ğŸ‡§ğŸ‡¼ğŸ‡§ğŸ‡¦ğŸ‡µğŸ‡±ğŸ‡§ğŸ‡ªğŸ‡µğŸ‡ªğŸ‡§ğŸ‡¿ğŸ‡§ğŸ‡¾ğŸ‡­ğŸ‡³ğŸ‡²ğŸ‡­ğŸ‡²ğŸ‡´ğŸ‡²ğŸ‡¬ğŸ‡¾ğŸ‡¹ğŸ‡²ğŸ‡¼ğŸ‡²ğŸ‡±ğŸ‡²ğŸ‡¹ğŸ‡²ğŸ‡¶ğŸ‡²ğŸ‡¨ğŸ‡²ğŸ‡¿ğŸ‡²ğŸ‡·ğŸ‡²ğŸ‡ºğŸ‡²ğŸ‡½ğŸ‡²ğŸ‡²ğŸ‡«ğŸ‡²ğŸ‡®ğŸ‡²ğŸ‡²ğŸ‡¾ğŸ‡²ğŸ‡»ğŸ‡²ğŸ‡©ğŸ‡²ğŸ‡¦ğŸ‡²ğŸ‡³ğŸ‡²ğŸ‡ªğŸ‡²ğŸ‡¸ğŸ‡¯ğŸ‡´ğŸ‡±ğŸ‡»ğŸ‡±ğŸ‡§ğŸ‡±ğŸ‡¸ğŸ‡·ğŸ‡¼ğŸ‡±ğŸ‡ºğŸ‡·ğŸ‡´ğŸ‡±ğŸ‡·ğŸ‡±ğŸ‡®ğŸ‡±ğŸ‡¾ğŸ‡±ğŸ‡¹ğŸ‡·ğŸ‡ªğŸ‡·ğŸ‡ºğŸ‡»ğŸ‡¬ğŸ‡ªğŸ‡ºğŸ‡°ğŸ‡·ğŸ‡ªğŸ‡­ğŸ‡­ğŸ‡°ğŸ‡¬ğŸ‡¶ğŸ‡¨ğŸ‡«ğŸ‡¨ğŸ‡³ğŸ‡¹ğŸ‡±ğŸ‡¸ğŸ‡¸ğŸ‡¦ğŸ‡¶ğŸ‡¯ğŸ‡µğŸŒğŸ‡¬ğŸ‡«ğŸ‡µğŸ‡«ğŸ‡°ğŸ‡µğŸ‡²ğŸ‡µğŸ‡²ğŸ‡°ğŸ‡¦ğŸ‡¸ğŸ‡»ğŸ‡®ğŸ‡¹ğŸ‡«âœ¡âœ³âœ´â‡â˜¯âœ‚â˜˜âœ‰âœ”âœ˜âš§âœâœ’â™Ÿ emoji cool"
}

# âœ… Merging Marathi and Hindi stopwords
custom_stopwords = marathi_stopwords.union(hindi_stopwords)

# Function to fetch statistics
def fetch_stats(selected_user, df):
    if selected_user != "Overall":
        df = df[df['user'] == selected_user]

    num_messages = df.shape[0]
    num_words = df['message'].apply(lambda x: len(str(x).split())).sum()
    num_media = df[df['message'] == "<Media omitted>"].shape[0]
    num_links = df['message'].str.contains(r'http[s]?://', regex=True).sum()

    return num_messages, num_words, num_media, num_links

# Function to generate the monthly timeline
def monthly_timeline(selected_user, df):
    if selected_user != "Overall":
        df = df[df['user'] == selected_user]

    timeline = df.groupby(['year', 'month']).count()['message'].reset_index()
    timeline['month'] = timeline['month'].astype(str) + "-" + timeline['year'].astype(str)

    return timeline[['month', 'message']].rename(columns={'message': 'message_count'})

# Function to create the activity heatmap
def activity_heatmap(selected_user, df):
    if selected_user != "Overall":
        df = df[df['user'] == selected_user]

    activity = df.pivot_table(index="day_name", columns="hour", values="message", aggfunc="count").fillna(0)
    fig, ax = plt.subplots(figsize=(10, 6))
    sns.heatmap(activity, cmap="coolwarm", ax=ax)

    return fig

# Function to create the word cloud
def create_wordcloud(selected_user, df):
    stop_words = set(stopwords.words('english')).union(custom_stopwords)  # âœ… Combine Marathi, Hindi & English stopwords

    if selected_user != "Overall":
        df = df[df['user'] == selected_user]

    # Filter out media messages
    filtered_messages = df[~df['message'].str.contains("Media omitted|omitted media", case=False, na=False, regex=True)]['message']

    # Generate WordCloud while removing stopwords
    text = " ".join(filtered_messages)
    wc = WordCloud(width=500, height=500, min_font_size=10, stopwords=stop_words, background_color='black').generate(text)

    return wc

# Function to get most common words
def most_common_words(selected_user, df):
    stop_words = set(stopwords.words('english')).union(custom_stopwords)  # âœ… Combine Marathi, Hindi & English stopwords

    if selected_user != "Overall":
        df = df[df['user'] == selected_user]

    words = []
    for msg in df['message']:
        for word in msg.lower().split():
            if word not in stop_words and word.isalpha():
                words.append(word)

    common_words_df = pd.DataFrame(Counter(words).most_common(20), columns=["Word", "Frequency"])
    return common_words_df

# Function to find most active users
def most_active_users(df):
    user_counts = df['user'].value_counts().head()
    user_df = user_counts.reset_index().rename(columns={'index': 'User', 'user': 'Message Count'})

    fig, ax = plt.subplots()
    ax.bar(user_counts.index, user_counts.values, color='purple')
    plt.xticks(rotation='vertical')

    return user_df, fig

# Function to analyze emoji usage
def emoji_analysis(selected_user, df):
    if selected_user != "Overall":
        df = df[df['user'] == selected_user]

    emojis = []
    for message in df['message']:
        emojis.extend([c for c in message if c in emoji.EMOJI_DATA])

    emoji_counter = Counter(emojis)
    emoji_df = pd.DataFrame(emoji_counter.most_common(len(emoji_counter)), columns=["Emoji", "Frequency"])

    return emoji_df

# Function to find most busy day
def most_busy_day(selected_user, df):
    if selected_user != "Overall":
        df = df[df['user'] == selected_user]

    busy_day = df['day_name'].value_counts()
    return busy_day

# Function to find most busy month
def most_busy_month(selected_user, df):
    if selected_user != "Overall":
        df = df[df['user'] == selected_user]

    busy_month = df['month'].value_counts()
    return busy_month
